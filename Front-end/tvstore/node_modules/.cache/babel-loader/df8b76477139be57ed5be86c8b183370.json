{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Initialize = _interopRequireDefault(require(\"./Initialize\"));\n\nvar _Subscribe = _interopRequireDefault(require(\"./Subscribe\"));\n\nvar _Fields = _interopRequireDefault(require(\"./constants/Fields\"));\n\nvar _LoginStatus = _interopRequireDefault(require(\"./constants/LoginStatus\"));\n\nvar Profile = /*#__PURE__*/function (_Component) {\n  (0, _inheritsLoose2.default)(Profile, _Component);\n\n  function Profile() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"state\", {\n      loading: true\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleReady\", function _callee(api) {\n      return _regenerator.default.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.api = api;\n\n              _this.updateProfile();\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleStatusChange\", function () {\n      _this.updateProfile();\n    });\n    return _this;\n  }\n\n  var _proto = Profile.prototype;\n\n  _proto.updateProfile = function updateProfile() {\n    var api, fields, response, profile;\n    return _regenerator.default.async(function updateProfile$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            api = this.api, fields = this.props.fields;\n\n            if (api) {\n              _context2.next = 3;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 3:\n            _context2.prev = 3;\n            _context2.next = 6;\n            return _regenerator.default.awrap(api.getLoginStatus());\n\n          case 6:\n            response = _context2.sent;\n\n            if (!(response.status !== _LoginStatus.default.CONNECTED)) {\n              _context2.next = 10;\n              break;\n            }\n\n            this.setState({\n              profile: undefined,\n              loading: false,\n              error: undefined\n            });\n            return _context2.abrupt(\"return\");\n\n          case 10:\n            _context2.next = 12;\n            return _regenerator.default.awrap(api.getProfile({\n              fields: fields\n            }));\n\n          case 12:\n            profile = _context2.sent;\n            this.setState({\n              profile: profile,\n              loading: false,\n              error: undefined\n            });\n            _context2.next = 19;\n            break;\n\n          case 16:\n            _context2.prev = 16;\n            _context2.t0 = _context2[\"catch\"](3);\n            this.setState({\n              profile: undefined,\n              loading: false,\n              error: _context2.t0\n            });\n\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, this, [[3, 16]]);\n  };\n\n  _proto.render = function render() {\n    var children = this.props.children;\n    var _this$state = this.state,\n        profile = _this$state.profile,\n        loading = _this$state.loading,\n        error = _this$state.error;\n    return _react.default.createElement(_Initialize.default, {\n      onReady: this.handleReady\n    }, _react.default.createElement(_Subscribe.default, {\n      event: \"auth.statusChange\",\n      onChange: this.handleStatusChange\n    }, children({\n      profile: profile,\n      loading: loading,\n      error: error\n    })));\n  };\n\n  return Profile;\n}(_react.Component);\n\nexports.default = Profile;\n(0, _defineProperty2.default)(Profile, \"defaultProps\", {\n  fields: _Fields.default\n});","map":{"version":3,"sources":["../src/Profile.jsx"],"names":["Profile","Component","fields","Fields","loading","updateProfile","api","response","LoginStatus","profile","error","undefined","render","children","handleReady","handleStatusChange"],"mappings":"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","sourcesContent":["// @flow\nimport React, { Component } from 'react';\nimport Initialize from './Initialize';\nimport Subscribe from './Subscribe';\nimport Fields from './constants/Fields';\nimport LoginStatus from './constants/LoginStatus';\n\ntype Props = {\n  children: Function,\n  fields?: string[],\n};\n\ntype State = {\n  loading: Boolean,\n  profile?: Object,\n  error?: Error,\n};\n\nexport default class Profile extends Component<Props, State> {\n  static defaultProps = {\n    fields: Fields,\n  };\n\n  state: State = {\n    loading: true,\n  };\n\n  handleReady = async (api: Object): Promise<void> => {\n    this.api = api;\n\n    this.updateProfile();\n  }\n\n  handleStatusChange = (): void => {\n    this.updateProfile();\n  }\n\n  async updateProfile() {\n    const { api, props: { fields } } = this;\n    if (!api) {\n      return;\n    }\n\n    try {\n      const response = await api.getLoginStatus();\n      if (response.status !== LoginStatus.CONNECTED) {\n        this.setState({\n          profile: undefined,\n          loading: false,\n          error: undefined,\n        });\n\n        return;\n      }\n\n      const profile = await api.getProfile({\n        fields,\n      });\n\n      this.setState({\n        profile,\n        loading: false,\n        error: undefined,\n      });\n    } catch (error) {\n      this.setState({\n        profile: undefined,\n        loading: false,\n        error,\n      });\n    }\n  }\n\n  render() {\n    const { children } = this.props;\n    const { profile, loading, error } = this.state;\n\n    return (\n      <Initialize onReady={this.handleReady}>\n        <Subscribe event=\"auth.statusChange\" onChange={this.handleStatusChange}>\n          {children({\n            profile,\n            loading,\n            error,\n          })}\n        </Subscribe>\n      </Initialize>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"script"}