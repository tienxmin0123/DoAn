{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _Process = _interopRequireDefault(require(\"./Process\"));\n\nvar _Fields = _interopRequireDefault(require(\"./constants/Fields\"));\n\nvar Login = /*#__PURE__*/function (_Component) {\n  (0, _inheritsLoose2.default)(Login, _Component);\n\n  function Login() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"handleClick\", function _callee2(evn) {\n      var _this$props, handleProcess, onCompleted, onError, onSuccess;\n\n      return _regenerator.default.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              evn.preventDefault();\n              _this$props = _this.props, handleProcess = _this$props.handleProcess, onCompleted = _this$props.onCompleted, onError = _this$props.onError, onSuccess = _this$props.onSuccess;\n              _context2.prev = 2;\n              _context2.next = 5;\n              return _regenerator.default.awrap(handleProcess(function _callee(api) {\n                var _this$props2, scope, fields, returnScopes, rerequest, reauthorize, eventKey, loginQpts, authType, loginResponse, data;\n\n                return _regenerator.default.async(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _this$props2 = _this.props, scope = _this$props2.scope, fields = _this$props2.fields, returnScopes = _this$props2.returnScopes, rerequest = _this$props2.rerequest, reauthorize = _this$props2.reauthorize, eventKey = _this$props2.eventKey;\n                        loginQpts = {\n                          scope: scope\n                        };\n                        authType = [];\n\n                        if (returnScopes) {\n                          loginQpts.return_scopes = true;\n                        }\n\n                        if (rerequest) {\n                          authType.push('rerequest');\n                        }\n\n                        if (reauthorize) {\n                          authType.push('reauthenticate');\n                        }\n\n                        if (authType.length) {\n                          loginQpts.auth_type = authType.join(',');\n                        }\n\n                        _context.next = 9;\n                        return _regenerator.default.awrap(api.login(loginQpts));\n\n                      case 9:\n                        loginResponse = _context.sent;\n\n                        if (!(loginResponse.status !== 'connected')) {\n                          _context.next = 12;\n                          break;\n                        }\n\n                        throw new Error('Unauthorized user');\n\n                      case 12:\n                        _context.next = 14;\n                        return _regenerator.default.awrap(api.getTokenDetailWithProfile({\n                          fields: fields\n                        }, loginResponse));\n\n                      case 14:\n                        data = _context.sent;\n\n                        if (!onCompleted) {\n                          _context.next = 18;\n                          break;\n                        }\n\n                        _context.next = 18;\n                        return _regenerator.default.awrap(onCompleted((0, _extends2.default)({}, data, {\n                          eventKey: eventKey\n                        })));\n\n                      case 18:\n                        return _context.abrupt(\"return\", data);\n\n                      case 19:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                });\n              }, onSuccess));\n\n            case 5:\n              _context2.next = 10;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](2);\n\n              if (onError) {\n                onError(_context2.t0);\n              }\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, [[2, 7]]);\n    });\n    return _this;\n  }\n\n  var _proto = Login.prototype;\n\n  _proto.render = function render() {\n    var _this$props3 = this.props,\n        children = _this$props3.children,\n        loading = _this$props3.loading,\n        error = _this$props3.error,\n        data = _this$props3.data;\n    return children({\n      loading: loading,\n      handleClick: this.handleClick,\n      error: error,\n      data: data\n    });\n  };\n\n  return Login;\n}(_react.Component);\n\n(0, _defineProperty2.default)(Login, \"defaultProps\", {\n  scope: '',\n  fields: _Fields.default,\n  returnScopes: false,\n  rerequest: false,\n  reauthorize: false,\n  onCompleted: undefined,\n  onError: undefined,\n  eventKey: undefined\n});\n\nvar _default = (0, _react.forwardRef)(function (props, ref) {\n  return _react.default.createElement(_Process.default, null, function (_ref) {\n    var loading = _ref.loading,\n        handleProcess = _ref.handleProcess,\n        data = _ref.data,\n        error = _ref.error;\n    return _react.default.createElement(Login, (0, _extends2.default)({}, props, {\n      loading: loading,\n      handleProcess: handleProcess,\n      data: data,\n      error: error,\n      ref: ref\n    }));\n  });\n});\n\nexports.default = _default;","map":{"version":3,"sources":["../src/Login.jsx"],"names":["Login","Component","scope","fields","Fields","returnScopes","rerequest","reauthorize","onCompleted","onError","eventKey","undefined","evn","handleProcess","onSuccess","loginQpts","authType","loginResponse","api","data","render","children","loading","error","handleClick","ref"],"mappings":"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","sourcesContent":["// @flow\nimport React, { Component, forwardRef } from 'react';\nimport Process from './Process';\nimport Fields from './constants/Fields';\n\ntype Props = {\n  children: Function,\n  handleProcess: Function,\n  loading: boolean,\n  data: any,\n  error: Error,\n  scope?: string,\n  fields?: string[],\n  returnScopes?: boolean,\n  rerequest?: boolean,\n  reauthorize?: boolean,\n  onCompleted?: Function,\n  onError?: Function,\n  eventKey?: any,\n};\n\nclass Login extends Component<Props> {\n  static defaultProps = {\n    scope: '',\n    fields: Fields,\n    returnScopes: false,\n    rerequest: false,\n    reauthorize: false,\n    onCompleted: undefined,\n    onError: undefined,\n    eventKey: undefined,\n  };\n\n  handleClick = async (evn) => {\n    evn.preventDefault();\n\n    const {\n      handleProcess, onCompleted, onError, onSuccess,\n    } = this.props;\n\n    try {\n      await handleProcess(async (api) => {\n        const {\n          scope, fields, returnScopes, rerequest, reauthorize, eventKey,\n        } = this.props;\n        const loginQpts = { scope };\n        const authType = [];\n\n        if (returnScopes) {\n          loginQpts.return_scopes = true;\n        }\n\n        if (rerequest) {\n          authType.push('rerequest');\n        }\n\n        if (reauthorize) {\n          authType.push('reauthenticate');\n        }\n\n        if (authType.length) {\n          loginQpts.auth_type = authType.join(',');\n        }\n\n        const loginResponse = await api.login(loginQpts);\n        if (loginResponse.status !== 'connected') {\n          throw new Error('Unauthorized user');\n        }\n\n        const data = await api.getTokenDetailWithProfile({ fields }, loginResponse);\n\n        if (onCompleted) {\n          await onCompleted({\n            ...data,\n            eventKey,\n          });\n        }\n\n        return data;\n      }, onSuccess);\n    } catch (error) {\n      if (onError) {\n        onError(error);\n      }\n    }\n  }\n\n  render() {\n    const {\n      children, loading, error, data,\n    } = this.props;\n\n    return children({\n      loading,\n      handleClick: this.handleClick,\n      error,\n      data,\n    });\n  }\n}\n\nexport default forwardRef((props, ref) => (\n  <Process>\n    {({\n      loading, handleProcess, data, error,\n    }) => (\n      <Login\n        {...props}\n        loading={loading}\n        handleProcess={handleProcess}\n        data={data}\n        error={error}\n        ref={ref}\n      />\n    )}\n  </Process>\n));\n"]},"metadata":{},"sourceType":"script"}